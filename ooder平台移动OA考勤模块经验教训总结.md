# ooder平台移动OA考勤模块经验教训总结

## 1. 设计阶段经验

### 1.1 架构设计
1. **视图与服务分离**：严格遵循视图类与服务类分离的设计原则，每个视图类对应一个或多个服务类
2. **BAR服务分类**：将BAR服务分为两类：具有Web访问能力的BAR服务和仅提供菜单配置的BAR服务
3. **模块无入口类**：遵循ood规范，不创建传统的模块入口类，主入口为普通的Web服务方法

### 1.2 注解使用
1. **注解一致性**：所有服务类都必须使用@Aggregation注解声明服务类型和用户空间
2. **Web访问规范**：所有通用服务必须具备Web可访问性，使用Spring MVC注解
3. **事件处理规范**：合理使用@APIEventAnnotation定义事件处理行为

## 2. 实现阶段经验

### 2.1 视图实现
1. **视图单一性**：列表视图保持单一性，不混合使用表单和网格注解
2. **字段注解**：正确使用@CustomAnnotation定义字段显示信息，包括caption、index等
3. **主键标识**：列表视图中正确使用@Uid注解标识行主键

### 2.2 服务实现
1. **BAR服务实现**：
   - 具有Web访问能力的BAR服务需要添加Spring MVC注解
   - 仅提供菜单配置的BAR服务不需要Web访问注解
   - 合理使用@ToolBarMenu、@BottomBarMenu等注解配置工具栏和底部栏

2. **导航服务实现**：
   - 导航服务处理视图间的跳转
   - 使用@Aggregation(type = AggregationType.MENU, userSpace = UserSpace.SYS)声明服务类型

3. **查询服务实现**：
   - 查询服务处理视图的业务逻辑
   - 使用@Aggregation(type = AggregationType.API, userSpace = UserSpace.SYS)声明服务类型

### 2.3 数据处理
1. **枚举使用**：为具有固定选项的字段定义对应的枚举类，使用@ComboBoxAnnotation和@CustomListAnnotation结合实现
2. **序列化规范**：所有Web服务的返回数据必须遵循fastjson规范，使用@JSONField等注解进行序列化配置
3. **异常处理**：包含完整的异常处理，设置正确的请求状态码

## 3. 遇到的问题及解决方案

### 3.1 Spring导入问题
**问题描述**：在创建服务类时出现Spring注解导入错误
**解决方案**：
1. 确认项目pom.xml中正确配置了Spring依赖
2. 使用正确的Spring注解包路径
3. 确保IDE正确识别Maven依赖

### 3.2 注解冗余问题
**问题描述**：同时使用了@View和MCP注解导致冗余
**解决方案**：移除冗余的@View注解，保持注解使用的简洁性

### 3.3 BAR服务规范问题
**问题描述**：最初实现的BAR服务不符合规范
**解决方案**：
1. 将BAR服务分为两类：具有Web访问能力的和仅提供菜单配置的
2. 正确使用@Aggregation注解声明服务类型
3. 合理配置工具栏和底部栏

## 4. 最佳实践

### 4.1 代码组织
1. **包结构清晰**：按照功能划分包结构，便于维护和扩展
2. **类命名规范**：采用有意义的类名，便于理解类的用途
3. **注释完整**：为每个类和方法添加详细的注释说明

### 4.2 注解使用
1. **注解一致性**：保持注解使用的一致性，遵循平台规范
2. **避免冗余**：避免使用功能重复的注解
3. **合理配置**：根据实际需求合理配置注解参数

### 4.3 服务设计
1. **职责单一**：每个服务类职责单一，便于维护和测试
2. **接口明确**：服务类接口明确，便于其他模块调用
3. **扩展性好**：服务类设计具有良好的扩展性，便于功能扩展

## 5. 注意事项

### 5.1 规范遵循
1. 严格遵循ooder平台的设计规范
2. 正确使用平台提供的注解
3. 遵循Web服务序列化规范

### 5.2 代码质量
1. 保持代码简洁性
2. 确保代码可读性
3. 注重代码可维护性

### 5.3 团队协作
1. 统一编码规范
2. 及时更新文档
3. 充分沟通交流